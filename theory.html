<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theory and package structure &mdash; pyforce 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "tags": "ams", "useLabelIds": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials.html" />
    <link rel="prev" title="Installation notes" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/pyforce_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Welcome to <em>pyforce</em>’s documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation notes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory and package structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-reduced-order-modelling">What is Reduced Order Modelling?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reduced-basis-methods">Reduced Basis Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-driven-rom-techniques">Data-Driven ROM techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="#package-structure">Package structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#offline-phase">Offline Phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#online-phase">Online Phase</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pyforce.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyforce</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Theory and package structure</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/theory.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="theory-and-package-structure">
<h1>Theory and package structure<a class="headerlink" href="#theory-and-package-structure" title="Link to this heading"></a></h1>
<p>This section presents the main ideas behind Reduced Order Modelling (ROM) <span id="id1">[<a class="reference internal" href="bibliography.html#id7" title="D. Degen, K. Veroy, and F. Wellmann. How Uncertainty Quantification and Reduced Order Modeling Change our Model Understanding. In AGU Fall Meeting Abstracts, volume 2020, T015-0002. December 2020. URL: https://ui.adsabs.harvard.edu/abs/2020AGUFMT015.0002D.">DVW20a</a>, <a class="reference internal" href="bibliography.html#id6" title="Yvon Maday and Anthony T Patera. 4 Reduced basis methods. In Peter Benner, Stefano Grivet-Talocia, Alfio Quarteroni, Gianluigi Rozza, Wil Schilders, and Luís Miguel Silveira, editors, Volume 2 Snapshot-Based Methods and Algorithms, pages 139–180. De Gruyter, 2020. doi:doi:10.1515/9783110671490-004.">MP20</a>, <a class="reference internal" href="bibliography.html#id5" title="Alfio Quarteroni, Andrea Manzoni, and Federico Negri. Reduced Basis Methods for Partial Differential Equations. Springer International Publishing, 2016. doi:10.1007/978-3-319-15431-2.">QMN16</a>]</span>, focusing on data-driven paradigm of these techniques. Then, the structure of the package is presented showing how the different classes are connected to each other.</p>
<section id="what-is-reduced-order-modelling">
<h2>What is Reduced Order Modelling?<a class="headerlink" href="#what-is-reduced-order-modelling" title="Link to this heading"></a></h2>
<p>In scientific literature, the expression Reduced Order Modelling is related to a set of techniques devoted to the search for an optimal coordinate system onto which some parametric solutions of Partial Differential Equations (PDEs) - typically called High-Fidelity (HF) or Full Order Model (FOM) - can be represented. These methods are very useful in multi-query and real-time scenarios, when quick and efficient solutions of models are required, e.g. optimization, uncertainty quantification and inverse problems <span id="id2">[<a class="reference internal" href="bibliography.html#id8" title="Denise Degen, Karen Veroy, and Florian Wellmann. Uncertainty quantification for basin-scale geothermal conduction models. Scientific Reports, 12:, 03 2022. doi:10.1038/s41598-022-08017-2.">DVW22</a>, <a class="reference internal" href="bibliography.html#id9" title="Theron Guo, Ondřej Rokoš, and Karen Veroy. Learning constitutive models from microstructural simulations via a non-intrusive reduced basis method. Computer Methods in Applied Mechanics and Engineering, 384:113924, 2021. doi:https://doi.org/10.1016/j.cma.2021.113924.">GRV21</a>]</span>. Recently, with the developments in data-driven modelling, a lot of interest in the combination of data and models has been raised. ROM offers new opportunities both to integrate the model with experimental data in real-time and to define methods of sensor positioning, by providing efficient tools to compress the prior knowledge about the system coming from the parametrized mathematical model into low-dimensional forms.</p>
<section id="reduced-basis-methods">
<h3>Reduced Basis Methods<a class="headerlink" href="#reduced-basis-methods" title="Link to this heading"></a></h3>
<p>Among all ROM methods, Reduced Basis (RB) methods <span id="id3">[<a class="reference internal" href="bibliography.html#id12" title="Denise Degen, Karen Veroy, and Florian Wellmann. Certified reduced basis method in geosciences. Computational Geosciences, 24:1-19, 02 2020. doi:10.1007/s10596-019-09916-6.">DVW20b</a>, <a class="reference internal" href="bibliography.html#id11" title="Jan S Hesthaven, Gianluigi Rozza, and Benjamin Stamm. Certified Reduced Basis Methods for Parametrized Partial Differential Equations. Springer International Publishing, 2016. doi:10.1007/978-3-319-22470-1.">HRS16</a>, <a class="reference internal" href="bibliography.html#id10" title="Alfio Quarteroni and Gianluigi Rozza. Reduced Order Methods for Modeling and Computational Reduction. Springer International Publishing, 2014. doi:10.1007/978-3-319-02090-7.">QR14</a>]</span> are a well-established and widely used class of ROM techniques, which are based on an offline-online paradigm. In the offline stage, a set of RB functions <span class="math notranslate nohighlight">\(\psi_n(\mathbf{x})\)</span> is derived from an ensemble of high-fidelity solutions, called <em>snapshots</em>, yielding a low-dimensional space that retains the main features of the full-order model. Different approaches can be used to construct the reduced basis, such as the <strong>greedy</strong> algorithms <span id="id4">[<a class="reference internal" href="bibliography.html#id13" title="Yvon Maday. Reduced basis method for the rapid and reliable solution of partial differential equations. November 2006. Preprint. URL: https://hal.archives-ouvertes.fr/hal-00112152.">Mad06</a>]</span> and the Proper Orthogonal Decomposition <strong>POD</strong> <span id="id5">[<a class="reference internal" href="bibliography.html#id14" title="G Berkooz, P Holmes, and J L Lumley. The proper orthogonal decomposition in the analysis of turbulent flows. Annual Review of Fluid Mechanics, 25(1):539–575, jan 1993. doi:10.1146/annurev.fl.25.010193.002543.">BHL93</a>]</span>, directly related to the Singular Value Decomposition (SVD) <span id="id6">[<a class="reference internal" href="bibliography.html#id18" title="Steven L Brunton and J Nathan Kutz. Data-Driven Science and Engineering: Machine Learning, Dynamical Systems, and Control. Cambridge University Press, USA, 1st edition, 2019. ISBN 1108422098. URL: http://www.databookuw.com.">BK19</a>]</span>. Regardless of the construction strategy, an approximation of the high-fidelity solution is sought during the online stage as a linear combination of the RB functions <span class="math notranslate nohighlight">\(\{\psi_n(\mathbf{x})\}\)</span>, i.e.</p>
<div class="math notranslate nohighlight">
\[    u(\mathbf{x}\;\mu) \simeq \sum_{n=1}^N\alpha_n(\mu)\cdot \psi_n(\mathbf{x})\]</div>
<p>According to the methodology for calculating the expansion coefficients <span class="math notranslate nohighlight">\(\alpha_n(\mu)\)</span> (also called reduced coefficients or latent dynamics) of the approximation, RB methods are classified into two categories: <em>intrusive</em> and <em>non-intrusive</em> RB methods.</p>
<ul class="simple">
<li><p><em>Intrusive</em>: the governing equations of the physical system, to which the snapshots are solution, must be known and used during the online step. From a set of PDEs a rather small system of ODEs is derived, typically using Galerkin projection.</p></li>
<li><p><em>Non-Intrusive</em>: the governing equations knowledge is not required, a more data-driven approach is followed.</p></li>
</ul>
<p><em>pyforce</em> mainly focuses on the latter, since they are more suited for extension to include as input real experimental data, such as local measurements.</p>
</section>
</section>
<section id="data-driven-rom-techniques">
<h2>Data-Driven ROM techniques<a class="headerlink" href="#data-driven-rom-techniques" title="Link to this heading"></a></h2>
<p>Data-Driven Reduced Order Modelling (DDROM) <span id="id7">[<a class="reference internal" href="bibliography.html#id25" title="Antonio Cammi, Stefano Riva, Carolina Introini, Lorenzo Loi, and Enrico Padovani. Data-Driven Model Order Reduction for Sensor Positioning and Indirect Reconstruction with Noisy Data: Application to a Circulating Fuel Reactor. submitted to Nuclear Engineering and Design, :, 2024. URL:, doi:.">CRI+24</a>, <a class="reference internal" href="bibliography.html#id26" title="Stefano Riva, Carolina Introini, and Antonio Cammi. Multi-physics model bias correction with data-driven reduced order techniques: application to nuclear case studies. 2024. URL: https://www.sciencedirect.com/science/article/pii/S0307904X24003196, doi:https://doi.org/10.1016/j.apm.2024.06.040.">RIC24</a>]</span> is a set of techniques, combining theoretical modelling with real data collecting from a physical system. In particular, ROM is seen in a Data Assimilation (DA) framework <span id="id8">[<a class="reference internal" href="bibliography.html#id18" title="Steven L Brunton and J Nathan Kutz. Data-Driven Science and Engineering: Machine Learning, Dynamical Systems, and Control. Cambridge University Press, USA, 1st edition, 2019. ISBN 1108422098. URL: http://www.databookuw.com.">BK19</a>]</span>, so that the theoretical prediction, approximated by ROM, is corrected or updated by experimental evaluations of some fields (e.g., the local measurements of the temperature in a pipe or the neutron flux in a nuclear reactor).</p>
<p><img alt="General scheme of DDROM methods [&#64;RMP_2024].abel{fig:darom}" src="_images/tie_frighter.svg" /></p>
<p>The techniques implemented here follow the same underlying idea expressed in the Figure \ref{fig:darom}. They all share the typical offline/online paradigm of ROM techniques: the former is computationally expensive and it is performed only once, whereas the latter is cheap from the computational point of view and allows to have quick and reliable evaluations of the state of the system by merging background model knowledge and real evaluations of quantities of interest <span id="id9">[<a class="reference internal" href="bibliography.html#id20" title="Yvon Maday, Anthony Patera, James Penn, and Masayuki Yano. A parameterized-background data-weak approach to variational data assimilation: formulation, analysis, and application to acoustics. International Journal for Numerical Methods in Engineering, 2014. doi:10.1002/nme.4747.">MPPY14</a>]</span>.</p>
<p>During the offline (also called training) phase, a <em>high-fidelity</em> or Full Order Model (FOM), usually parameterised partial differential equations, is solved several times to obtain a collections of snapshots <span class="math notranslate nohighlight">\(\mathbf{u}_{FOM}\in\mathbb{R}^{\mathcal{N}_h}\)</span>, given <span class="math notranslate nohighlight">\(\mathcal{N}_h\)</span> the dimension of the spatial mesh, which are dependent on some parameters <span class="math notranslate nohighlight">\(\boldsymbol{\mu}_n\)</span>; then, these snapshots are used to generate a reduced representation through a set of basis functions <span class="math notranslate nohighlight">\(\{\psi_n(\mathbf{x})\}\)</span> of size <span class="math notranslate nohighlight">\(N\)</span>, in this way the degrees of freedom are decreased from <span class="math notranslate nohighlight">\(\mathcal{N}_h\)</span> to <span class="math notranslate nohighlight">\(N\)</span>, provided that <span class="math notranslate nohighlight">\(\mathcal{N}_h&gt;&gt;N\)</span>. This allows for an approximation of any solution of the FOM as follows</p>
<div class="math notranslate nohighlight">
\[u_{FOM}(\mathbf{x} ; \boldsymbol{\mu}) \simeq \sum_{n=1}^N\alpha_n(\boldsymbol{\mu})\cdot \psi_n(\mathbf{x})\]</div>
<p>with <span class="math notranslate nohighlight">\(\alpha_n(\boldsymbol{\mu})\)</span> as the reduced coefficients, embedding the parametric dependence. Moreover, a reduced representation allows for the search for the optimal positions of sensors in the physical domain in a more efficient manner.</p>
<p>The online phase aims to obtain a quick and reliable way a solution of the FOM for an unseen parameter <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^\star\)</span>, using as input a set of measurements <span class="math notranslate nohighlight">\(\mathbf{y}\in\mathbb{R}^M\)</span>. The DDROM online phase produces a novel set of reduced coordinates, <span class="math notranslate nohighlight">\(\boldsymbol{\alpha}^\star\)</span>, and then computes an improved reconstructed state <span class="math notranslate nohighlight">\(\hat{u}_{DDROM}\)</span> through a decoding step that transforms the low-dimensional representation to the high-dimensional one.</p>
</section>
<section id="package-structure">
<h2>Package structure<a class="headerlink" href="#package-structure" title="Link to this heading"></a></h2>
<p>The package <strong>pyforce</strong> comprises 3 subpackages: <em>offline</em>, <em>online</em> and <em>tools</em>. The first two collect the main functionalities, in particular the different DDROM techniques; whereas, the last includes importing and storing functions (from <em>dolfinx</em> directly or mapping from OpenFOAM), some backend classes for the snapshots and the calculation of integrals/norms. In the following, some figures are sketching how the different classes are connected to each other during the offline and online phases.</p>
<section id="offline-phase">
<h3>Offline Phase<a class="headerlink" href="#offline-phase" title="Link to this heading"></a></h3>
<p>Once the snapshots have been generated and collected into the class <code class="docutils literal notranslate"><span class="pre">FunctionsList</span></code>, the aims of this phase consists in generating a proper reduced representation and obtain an optimal sensors configuration.</p>
<p><img alt="Offline Phase" src="_images/offline_classes.svg" /></p>
</section>
<section id="online-phase">
<h3>Online Phase<a class="headerlink" href="#online-phase" title="Link to this heading"></a></h3>
<p>Given the basis functions and the sensors placed in the offline phase, the objective becomes the reconstruction of the state of the system given a set of local measurements of some characteristic fields. As reported in <span id="id10">[<a class="reference internal" href="bibliography.html#id25" title="Antonio Cammi, Stefano Riva, Carolina Introini, Lorenzo Loi, and Enrico Padovani. Data-Driven Model Order Reduction for Sensor Positioning and Indirect Reconstruction with Noisy Data: Application to a Circulating Fuel Reactor. submitted to Nuclear Engineering and Design, :, 2024. URL:, doi:.">CRI+24</a>, <a class="reference internal" href="bibliography.html#id22" title="Carolina Introini, Stefano Riva, Stefano Lorenzi, Simone Cavalleri, and Antonio Cammi. Non-intrusive system state reconstruction from indirect measurements: A novel approach based on Hybrid Data Assimilation methods. Annals of Nuclear Energy, 182:109538, 2023. URL: https://www.sciencedirect.com/science/article/pii/S0306454922005680, doi:https://doi.org/10.1016/j.anucene.2022.109538.">IRL+23</a>]</span>, the quantities of interest in a nuclear reactor can be quite a few and not all of them can be directly observed; therefore, supposing to have two coupled fields to reconstruct <span class="math notranslate nohighlight">\((\phi, \mathbf{u})\)</span> and only local evaluations of <span class="math notranslate nohighlight">\(\phi\)</span> are available, two different problems arise:</p>
<ul class="simple">
<li><p><strong>Direct State Estimation</strong>: from measurements of <span class="math notranslate nohighlight">\(\phi\)</span>, its spatial distribution has to be reconstructed (the information of <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is not entering in this stage)</p></li>
</ul>
<p><img alt="Offline Phase" src="_images/online_classes_direct.svg" /></p>
<ul class="simple">
<li><p><strong>Indirect State Estimation</strong>: from measurements of <span class="math notranslate nohighlight">\(\phi\)</span>, the spatial distribution of <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> has to be reconstructed</p></li>
</ul>
<p><img alt="Offline Phase" src="_images/online_classes_indirect.svg" /></p>
<p>In the end, there is another possibility which does not include the presence of measures: Assuming that the characteristic (unseen) parameter <span class="math notranslate nohighlight">\(\boldsymbol{\mu}^\star\)</span> is known, the full state can be reconstructed using a non-intrusive approach <span id="id11">[<a class="reference internal" href="bibliography.html#id27" title="Marco Tezzele, Nicola Demo, Andrea Mola, and Gianluigi Rozza. An integrated data-driven computational pipeline with model order reduction for industrial and applied mathematics. In Novel Mathematics Inspired by Industrial Challenges, pages 179–200. Springer International Publishing, Cham, 2022. doi:10.1007/978-3-030-96173-2_7.">TDMR22</a>]</span></p>
<p><img alt="Offline Phase" src="_images/online_classes_param.svg" /></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Stefano Riva, Carolina Introini, Antonio Cammi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>