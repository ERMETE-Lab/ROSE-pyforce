

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Online Phase: Indirect Reconstruction &mdash; pyforce 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "tags": "ams", "useLabelIds": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Laminar Flow Past a Cylinder using OpenFOAM-v2012" href="../04_flow_cyl.html" />
    <link rel="prev" title="Offline Phase: generating reduced coefficient maps" href="02c_offline_maps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/pyforce_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Welcome to <em>pyforce</em>’s documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">Theory and package structure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01_DFG2_benchmark.html">Unsteady Laminar Navier-Stokes - DFG2 benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_ANL11-A2_stationary.html">MultiGroup Neutron Diffusion - ANL11-A2 benchmark</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../03_buoyant_cavity.html">Steady Buoyant Navier-Stokes - Differentially Heated Cavity</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_import_OFsnaps.html">Import Snapshots from OF</a></li>
<li class="toctree-l3"><a class="reference internal" href="02a_offline_POD.html">Offline Phase: POD</a></li>
<li class="toctree-l3"><a class="reference internal" href="02b_offline_GEIM.html">Offline Phase: GEIM</a></li>
<li class="toctree-l3"><a class="reference internal" href="02c_offline_maps.html">Offline Phase: generation of the maps</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Online Phase: Indirect Reconstruction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Parameter-Estimation">Parameter Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Proper-Orthogonal-Decomposition-with-Interpolation-(POD-I)">Proper Orthogonal Decomposition with Interpolation (POD-I)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Post-Process">Post Process</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_flow_cyl.html">Navier-Stokes (PimpleFoam) - Flow Over Cylinder</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/pyforce.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyforce</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorials.html">Tutorials</a></li>
          <li class="breadcrumb-item"><a href="../03_buoyant_cavity.html">Steady Buoyant Navier-Stokes for Differentially Heated Cavity</a></li>
      <li class="breadcrumb-item active">Online Phase: Indirect Reconstruction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Tutorials/03_BuoyantCavity_OF6/03_online_IR.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Online-Phase:-Indirect-Reconstruction">
<h1>Online Phase: Indirect Reconstruction<a class="headerlink" href="#Online-Phase:-Indirect-Reconstruction" title="Link to this heading"></a></h1>
<p><strong>Aim of this notebook</strong>: This notebook aims to provide a simple example of the online phase of the Indirect Reconstruction (IR) method, proposed by <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0306454922005680">Introini et al., 2023</a>. In particular, the case study of buoyancy-driven flow in a square cavity is considered. This algorithm consists of two main steps: firstly, the Parameter Estimation (PE) is performed, and then the Proper Orthogonal Decomposition with Interpolation
(POD-I) is applied.</p>
<hr class="docutils" />
<p><em>To execute this notebook</em>: the test snapshots should be placed in <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code>, the magic functions and sensors for the temperature field are saved in <code class="docutils literal notranslate"><span class="pre">Offline_results</span></code>, the POD modes for the other fields should be saved there too and the coefficient maps must have been generated using previous notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mpi4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">MPI</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dolfinx.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">gmshio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dolfinx.fem</span><span class="w"> </span><span class="kn">import</span> <span class="n">FunctionSpace</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ufl</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyforce.tools.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">LoopProgress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyforce.tools.functions_list</span><span class="w"> </span><span class="kn">import</span> <span class="n">FunctionsList</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyforce.tools.write_read</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImportH5</span>
</pre></div>
</div>
</div>
<p>Let us generate the mesh for importing OpenFOAM dataset into <em>dolfinx</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mesh_comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="n">model_rank</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Initialize the gmsh module</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="c1"># Load the .geo file</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="s1">&#39;cavity.geo&#39;</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

<span class="c1"># Set algorithm (adaptive = 1, Frontal-Delaunay = 6)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.Algorithm&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">gdim</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Linear Finite Element</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">gdim</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="s2">&quot;Netgen&quot;</span><span class="p">)</span>

<span class="c1"># Import into dolfinx</span>
<span class="n">model_rank</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">domain</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ft</span> <span class="o">=</span> <span class="n">gmshio</span><span class="o">.</span><span class="n">model_to_mesh</span><span class="p">(</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="p">,</span> <span class="n">model_rank</span><span class="p">,</span> <span class="n">gdim</span> <span class="o">=</span> <span class="n">gdim</span> <span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

<span class="n">tdim</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">dim</span>
<span class="n">fdim</span> <span class="o">=</span> <span class="n">tdim</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">domain</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">create_connectivity</span><span class="p">(</span><span class="n">fdim</span><span class="p">,</span> <span class="n">tdim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Info    : Reading &#39;cavity.geo&#39;...
Info    : Done reading &#39;cavity.geo&#39;
Info    : Meshing 1D...
Info    : [  0%] Meshing curve 1 (Line)
Info    : [ 30%] Meshing curve 2 (Line)
Info    : [ 60%] Meshing curve 3 (Line)
Info    : [ 80%] Meshing curve 4 (Line)
Info    : Done meshing 1D (Wall 0.00107815s, CPU 0.000847s)
Info    : Meshing 2D...
Info    : Meshing surface 1 (Transfinite)
Info    : Done meshing 2D (Wall 0.008234s, CPU 0.006448s)
Info    : 16384 nodes 32770 elements
Info    : Optimizing mesh (Netgen)...
Info    : Done optimizing mesh (Wall 2.792e-06s, CPU 3e-06s)
</pre></div></div>
</div>
<p>Let us define the variable names and the functional space onto which the OpenFOAM data have been projected</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;norm_T&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">]</span>
<span class="n">tex_var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\mathbf</span><span class="si">{u}</span><span class="s1">&#39;</span><span class="p">]</span>

<span class="n">fun_spaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">FunctionSpace</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Lagrange&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
              <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Lagrange&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
              <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">ufl</span><span class="o">.</span><span class="n">VectorElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">domain</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">1</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<p>Let us load the test snapshots</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./Snapshots/&#39;</span>

<span class="n">test_snaps</span>  <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">field_i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_names</span><span class="p">):</span>

    <span class="n">path_snap</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;TestSet_&#39;</span> <span class="o">+</span><span class="n">field</span>
    <span class="n">test_snaps</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">ImportH5</span><span class="p">(</span><span class="n">fun_spaces</span><span class="p">[</span><span class="n">field_i</span><span class="p">],</span> <span class="n">path_snap</span><span class="p">,</span> <span class="n">field</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The temperature is the only one that can be measured</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_idx</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<p>Let us import the GEIM magic functions and sensors and the POD modes for non-observable fields</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path_offline</span> <span class="o">=</span> <span class="s1">&#39;./Offline_results/&#39;</span>

<span class="c1"># Magic Functions and Sensors</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">ImportH5</span><span class="p">(</span><span class="n">fun_spaces</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">],</span> <span class="n">path_offline</span><span class="o">+</span><span class="s1">&#39;BasisFunctions/basisGEIM_&#39;</span><span class="o">+</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">],</span> <span class="s1">&#39;GEIM_&#39;</span><span class="o">+</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ms</span> <span class="o">=</span> <span class="n">ImportH5</span><span class="p">(</span><span class="n">fun_spaces</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">],</span> <span class="n">path_offline</span><span class="o">+</span><span class="s1">&#39;BasisSensors/sensorsGEIM_&#39;</span><span class="o">+</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">],</span> <span class="s1">&#39;GEIM_&#39;</span><span class="o">+</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># POD modes</span>
<span class="n">pod_modes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">field_i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_names</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">field_i</span> <span class="o">!=</span> <span class="n">obs_idx</span><span class="p">:</span>
        <span class="n">pod_modes</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">ImportH5</span><span class="p">(</span><span class="n">fun_spaces</span><span class="p">[</span><span class="n">field_i</span><span class="p">],</span> <span class="n">path_offline</span><span class="o">+</span><span class="s1">&#39;BasisFunctions/basisPOD_&#39;</span><span class="o">+</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">],</span> <span class="s1">&#39;POD_&#39;</span><span class="o">+</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>In the end, let us load the maps of the reduced coefficients</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geim_maps</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">path_offline</span><span class="o">+</span><span class="s1">&#39;maps.geim&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
<span class="n">pod_maps</span>  <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">path_offline</span><span class="o">+</span><span class="s1">&#39;maps.pod&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The snapshots are dependent on two different parameters: the Reynolds and the Richardson number. The test parameters are <span class="math">\begin{equation*}
Re_{test} = [17.5:10:147.5] \qquad \qquad Ri_{test} = [0.4:0.8:44]
\end{equation*}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dRe</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">dRi</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="c1"># Test Parameters</span>
<span class="n">Re_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="n">dRe</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">150</span><span class="o">+</span><span class="n">dRe</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dRe</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Ri_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="o">+</span><span class="n">dRi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>   <span class="mi">5</span><span class="o">+</span><span class="n">dRi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dRi</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

<span class="n">Ri</span><span class="p">,</span> <span class="n">Re</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Ri_test</span><span class="p">,</span> <span class="n">Re_test</span><span class="p">)</span>
<span class="n">mu_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">Re</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Ri</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<section id="Parameter-Estimation">
<h2>Parameter Estimation<a class="headerlink" href="#Parameter-Estimation" title="Link to this heading"></a></h2>
<p>In this section, the measurements of the observable field (temperature in this case) are used to find the characteristic parameter <span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span>, solution of the inverse problem <span class="math">\begin{equation*}
\boldsymbol{\mu}^\star = \text{arg }\min\limits_{\boldsymbol{\mu}\in\mathcal{D}}
\mathcal{L}_{PE}(\boldsymbol{\mu}) =
\text{arg }\min\limits_{\boldsymbol{\mu}\in\mathcal{D}}\|\mathbb{B}\boldsymbol{\beta}(\boldsymbol{\mu}) - \mathbf{y}\|_2^2 \qquad\qquad
\text{ given }\mathcal{F}_m(\boldsymbol{\mu}) = \beta_m(\boldsymbol{\mu})
\end{equation*}</span> with <span class="math notranslate nohighlight">\(\mathbb{B}\in\mathbb{R}^{M\times M}\)</span> a lower triangular matrix, whose components are given by the magic function <span class="math notranslate nohighlight">\(q_m\)</span> and sensors <span class="math notranslate nohighlight">\(v_m(\cdot)\)</span> as <span class="math notranslate nohighlight">\(\mathbb{B}_{mm'} = v_m\left(q_{m'}\right)\)</span>.</p>
<p>This matrix has to be defined exploiting the <code class="docutils literal notranslate"><span class="pre">norms</span></code> class from <code class="docutils literal notranslate"><span class="pre">pyforce</span></code> able to compute integrals.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyforce.tools.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">norms</span>

<span class="n">Mmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span>

<span class="n">norm</span> <span class="o">=</span> <span class="n">norms</span><span class="p">(</span><span class="n">fun_spaces</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">])</span>
<span class="n">matrix_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Mmax</span><span class="p">,</span> <span class="n">Mmax</span><span class="p">))</span>
<span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Mmax</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Mmax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nn</span> <span class="o">&gt;</span> <span class="n">mm</span><span class="p">:</span>
            <span class="n">matrix_B</span><span class="p">[</span><span class="n">mm</span><span class="p">,</span> <span class="n">nn</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">matrix_B</span><span class="p">[</span><span class="n">mm</span><span class="p">,</span> <span class="n">nn</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">L2innerProd</span><span class="p">(</span><span class="n">ms</span><span class="p">(</span><span class="n">mm</span><span class="p">),</span> <span class="n">mf</span><span class="p">(</span><span class="n">nn</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Now, for each snapshot of the observable field, let us compute the correspondent parameter.</p>
<p>This is implemented in the <code class="docutils literal notranslate"><span class="pre">PE</span></code> class, this needs to be initialised with the matrix <span class="math notranslate nohighlight">\(\mathbb{B}\)</span>, the maps for the GEIM reduced coefficients <span class="math notranslate nohighlight">\(\mathcal{F}_T(\boldsymbol{\mu}) = \boldsymbol{\beta}^T(\boldsymbol{\mu})\)</span> and the bounds for the parameters to be given as list of tuples.</p>
<p>The global optimisation is solved in two steps adopting the <em>scipy</em> package:</p>
<ul class="simple">
<li><p>First Guess using brute force (<code class="docutils literal notranslate"><span class="pre">brute</span></code>) or the differential evolution (<code class="docutils literal notranslate"><span class="pre">differential_evolution</span></code>) solver, which is a global optimisation method.</p></li>
<li><p>Check using least square solver to ensure proper convergence.</p></li>
</ul>
<p>This optimisation is implemented in the <code class="docutils literal notranslate"><span class="pre">synt_test_error</span></code> method, which requires the true parameter, the test snapshot for the observable field to compute the measures, the magic functions, the maximum number of sensors to use. Then, some additional options are available: random noise can be inserted with <code class="docutils literal notranslate"><span class="pre">noise_value</span></code>, the progress can be displayed with <code class="docutils literal notranslate"><span class="pre">verbose</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the choice to use brute force needs <code class="docutils literal notranslate"><span class="pre">use_brute</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code> and the number of grid element for brute
force is given by <code class="docutils literal notranslate"><span class="pre">grid_elem</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyforce.online.indirect_recon</span><span class="w"> </span><span class="kn">import</span> <span class="n">PE</span>

<span class="n">map_methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">geim_maps</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="n">bnds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">)]</span>

<span class="n">ave_absErr_pe</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">ave_relErr_pe</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">mu_estimated</span>  <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">comput_times</span>  <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="n">pe_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">map</span> <span class="ow">in</span> <span class="n">map_methods</span><span class="p">:</span>
        <span class="n">pe_data</span><span class="p">[</span><span class="nb">map</span><span class="p">]</span> <span class="o">=</span> <span class="n">PE</span><span class="p">(</span><span class="n">matrix_B</span><span class="p">,</span> <span class="n">geim_maps</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">]][</span><span class="nb">map</span><span class="p">],</span> <span class="n">bnds</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">pe_data</span><span class="p">[</span><span class="nb">map</span><span class="p">]</span><span class="o">.</span><span class="n">synt_test_error</span><span class="p">(</span><span class="n">mu_test</span><span class="p">,</span> <span class="n">test_snaps</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">obs_idx</span><span class="p">]],</span> <span class="n">ms</span><span class="p">,</span> <span class="n">Mmax</span><span class="p">,</span>
                                        <span class="n">noise_value</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">use_brute</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">grid_elem</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

        <span class="n">ave_absErr_pe</span><span class="p">[</span><span class="nb">map</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ave_relErr_pe</span><span class="p">[</span><span class="nb">map</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">comput_times</span><span class="p">[</span><span class="nb">map</span><span class="p">]</span>  <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">mu_estimated</span><span class="p">[</span><span class="nb">map</span><span class="p">]</span>  <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Solving Parameter Estimation : 84.000 / 84.00 - 4.043 s/it
Solving Parameter Estimation : 84.000 / 84.00 - 5.421 s/it
</pre></div></div>
</div>
<p>The output of the method <code class="docutils literal notranslate"><span class="pre">synt_test_error</span></code> is composed by 5 elements: the average absolute and relative errors, the computational times, the final estimated parameters and the results from the first step with brute force or differential evolution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">_fields</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;mean_abs_err&#39;, &#39;mean_rel_err&#39;, &#39;computational_time&#39;, &#39;mu_PE&#39;, &#39;mu_PE_guess&#39;)
</pre></div></div>
</div>
<p>Let us plot the average errors of the PE phase with respect to the number of measurements used</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="n">mu_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">mu_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">M_to_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Mmax</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$Re$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$Ri$&#39;</span><span class="p">]</span>

<span class="n">colors</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">map_methods</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">idx_mu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mu_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="nb">map</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">map_methods</span><span class="p">):</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">M_to_plot</span><span class="p">,</span> <span class="n">ave_absErr_pe</span><span class="p">[</span><span class="nb">map</span><span class="p">][:,</span> <span class="n">idx_mu</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">map</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">M_to_plot</span><span class="p">,</span> <span class="n">ave_relErr_pe</span><span class="p">[</span><span class="nb">map</span><span class="p">][:,</span> <span class="n">idx_mu</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">map</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Measurements $M$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Mmax</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Average Absolute Error - &#39;</span><span class="o">+</span><span class="n">parameters</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Average Relative Error - &#39;</span><span class="o">+</span><span class="n">parameters</span><span class="p">[</span><span class="n">idx_mu</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_23_0.png" src="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_23_0.png" />
</div>
</div>
</section>
<section id="Proper-Orthogonal-Decomposition-with-Interpolation-(POD-I)">
<h2>Proper Orthogonal Decomposition with Interpolation (POD-I)<a class="headerlink" href="#Proper-Orthogonal-Decomposition-with-Interpolation-(POD-I)" title="Link to this heading"></a></h2>
<p>We are going to use the estimated parameter (using <span class="math notranslate nohighlight">\(M_{max}\)</span> measures) to reconstruct the non-observable fields (pressure and velocity) using POD-I. This procedure is very similar to the case of Tutorial 1, in which the parameter was assumed to be known a priori and not determined by the measures.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyforce.online.pod_interpolation</span><span class="w"> </span><span class="kn">import</span> <span class="n">PODI</span>

<span class="n">podi_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">podi_res</span>  <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="n">Nmax</span> <span class="o">=</span> <span class="mi">20</span>

<span class="k">for</span> <span class="n">field_i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_names</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">field_i</span> <span class="o">!=</span> <span class="n">obs_idx</span><span class="p">:</span>
        <span class="n">podi_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">podi_res</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="n">bar</span> <span class="o">=</span> <span class="n">LoopProgress</span><span class="p">(</span><span class="s1">&#39;POD-I &#39;</span><span class="o">+</span><span class="n">field</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">map_methods</span><span class="p">))</span>
        <span class="k">for</span> <span class="nb">map</span> <span class="ow">in</span> <span class="n">map_methods</span><span class="p">:</span>
            <span class="n">podi_data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="nb">map</span><span class="p">]</span> <span class="o">=</span> <span class="n">PODI</span><span class="p">(</span><span class="n">pod_modes</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">pod_maps</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="nb">map</span><span class="p">],</span> <span class="n">field</span><span class="p">)</span>

            <span class="n">mu_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mu_estimated</span><span class="p">[</span><span class="nb">map</span><span class="p">])[:,</span> <span class="n">Mmax</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">podi_res</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="nb">map</span><span class="p">]</span> <span class="o">=</span> <span class="n">podi_data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="nb">map</span><span class="p">]</span><span class="o">.</span><span class="n">synt_test_error</span><span class="p">(</span><span class="n">test_snaps</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">)</span>
            <span class="n">bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">bar</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
POD-I p: 2.000 / 2.00 - 6.830 s/it
POD-I U: 2.000 / 2.00 - 7.696 s/it
</pre></div></div>
</div>
<p>Let us plot the mean absolute and relative errors for each field, respectively, defined as follows <span class="math">\begin{equation*}
\begin{split}
E_N[u] &= \left\langle \left\| u(\cdot;\,\boldsymbol{\mu}) - \mathcal{P}_N[u](\cdot;\,\boldsymbol{\mu})\right\|_{L^2(\Omega)}\right\rangle_{\boldsymbol{\mu}\in\Xi^{test}}\\
\varepsilon_N[u] &= \left\langle\frac{\left\| u(\cdot;\,\boldsymbol{\mu}) - \mathcal{P}_N[u](\cdot;\,\boldsymbol{\mu})\right\|_{L^2(\Omega)}}{\left\| u(\cdot;\,\boldsymbol{\mu}) \right\|_{L^2(\Omega)}}\right\rangle_{\boldsymbol{\mu}\in\Xi^{test}}
\end{split}
\end{equation*}</span> given <span class="math notranslate nohighlight">\(\mathcal{P}_N\)</span> the reconstruction operator with <span class="math notranslate nohighlight">\(N\)</span> basis functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">N_to_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">map_methods</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">field_i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_names</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">field_i</span> <span class="o">!=</span> <span class="n">obs_idx</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ax_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">map_i</span><span class="p">,</span> <span class="nb">map</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">map_methods</span><span class="p">):</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">N_to_plot</span><span class="p">,</span> <span class="n">podi_res</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="nb">map</span><span class="p">][</span><span class="n">ax_i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">map_i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">map</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

            <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">)</span>

            <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax_i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;POD basis rank $N$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_N[&#39;</span><span class="o">+</span><span class="n">tex_var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;]$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">field_i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\varepsilon[&#39;</span><span class="o">+</span><span class="n">tex_var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;]$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_27_0.png" src="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_27_0.png" />
</div>
</div>
</section>
<section id="Post-Process">
<h2>Post Process<a class="headerlink" href="#Post-Process" title="Link to this heading"></a></h2>
<p>In this last section, we are going to plot the computational times and some contour plots of the non-observable fields.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M_to_plot</span><span class="p">,</span> <span class="n">comput_times</span><span class="p">[</span><span class="s1">&#39;LinInt&#39;</span><span class="p">][</span><span class="s1">&#39;Optimisation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;b-o&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Mmax</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Measures $M$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;CPU Time - PE (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Iterate over field_i values</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">)))</span>  <span class="c1"># Choose a colormap</span>
<span class="k">for</span> <span class="n">field_i</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">)),</span> <span class="n">colors</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">field_i</span> <span class="o">!=</span> <span class="n">obs_idx</span><span class="p">:</span>

        <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">stds</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Calculate mean and std for each key</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">podi_res</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">podi_res</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]][</span><span class="n">key</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;CoeffEstimation&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">podi_res</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]][</span><span class="n">key</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;CoeffEstimation&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="n">stds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

        <span class="c1"># Plot the bar chart with error bars for standard deviation</span>
        <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Adjust as needed</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">podi_res</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
        <span class="n">bars</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">field_i</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span><span class="o">+</span><span class="n">tex_var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;CPU Time to estimate coeff (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">podi_res</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">field_i</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">.35</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_29_0.png" src="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_29_0.png" />
</div>
</div>
<p>Lastly, we can plot the reconstructed fields for the non-observable variables using the <code class="docutils literal notranslate"><span class="pre">reconstruct</span></code> method of the <code class="docutils literal notranslate"><span class="pre">PODI</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Nmax</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">reconstructions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">field_i</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_names</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">field_i</span> <span class="o">!=</span> <span class="n">obs_idx</span><span class="p">:</span>
        <span class="n">reconstructions</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">map_methods</span><span class="p">:</span>
            <span class="n">reconstructions</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">FunctionsList</span><span class="p">(</span><span class="n">fun_spaces</span><span class="p">[</span><span class="n">field_i</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_snaps</span><span class="p">[</span><span class="n">field</span><span class="p">])):</span>

            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">map_methods</span><span class="p">:</span>
                <span class="n">mu_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mu_estimated</span><span class="p">[</span><span class="nb">map</span><span class="p">])[:,</span> <span class="n">Mmax</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">reconstructions</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">podi_data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="nb">map</span><span class="p">]</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">test_snaps</span><span class="p">[</span><span class="n">field</span><span class="p">](</span><span class="n">mu</span><span class="p">),</span> <span class="n">mu_star</span><span class="p">[</span><span class="n">mu</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">Nmax</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>In the end, let us make some contour plots of the reconstructed fields with POD-I, using the <code class="docutils literal notranslate"><span class="pre">plot_FOM_vs_ROM</span></code> from the <code class="docutils literal notranslate"><span class="pre">contour_plotting.py</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">contour_plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_FOM_vs_ROM</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">plot_FOM_vs_ROM</span><span class="p">(</span><span class="n">test_snaps</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">reconstructions</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mu</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;POD-I at $\mu=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">varname</span><span class="o">=</span><span class="n">tex_var_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">_resolution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">],</span> <span class="n">zoom</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
                <span class="n">position_cb</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.843</span><span class="p">],</span>
                <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span> <span class="n">colormap_res</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">)</span>

<span class="n">plot_FOM_vs_ROM</span><span class="p">(</span><span class="n">test_snaps</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">reconstructions</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">mu</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;POD-I at $\mu=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">varname</span><span class="o">=</span><span class="n">tex_var_names</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">_resolution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">],</span> <span class="n">zoom</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
                <span class="n">position_cb</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.843</span><span class="p">],</span>
                <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">colormap_res</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">,</span>
                <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">,</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.025</span><span class="p">,</span> <span class="n">mag_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_33_0.png" src="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_33_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_33_1.png" src="../../_images/Tutorials_03_BuoyantCavity_OF6_03_online_IR_33_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="02c_offline_maps.html" class="btn btn-neutral float-left" title="Offline Phase: generating reduced coefficient maps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../04_flow_cyl.html" class="btn btn-neutral float-right" title="Laminar Flow Past a Cylinder using OpenFOAM-v2012" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Stefano Riva, Carolina Introini, Antonio Cammi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>